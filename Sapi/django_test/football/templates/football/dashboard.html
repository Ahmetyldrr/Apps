<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futbol Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .section h2 { color: #333; border-bottom: 2px solid #0066cc; padding-bottom: 10px; }
        .matches-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .match-card { background: #f9f9f9; padding: 15px; border-radius: 5px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; }
        .stat-card { background: #e8f4f8; padding: 15px; border-radius: 5px; text-align: center; }
        .league-table { width: 100%; border-collapse: collapse; }
        .league-table th, .league-table td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
        .league-table th { background-color: #f0f0f0; }
    </style>
</head>
<body>
    <h1>Futbol Dashboard - Çoklu Tablo Verileri</h1>
    
    <!-- BÖLÜM 1: BİTEN MAÇLAR -->
    <div class="section">
        <h2>🏁 Biten Maçlar ({{ finished_matches.count }} maç)</h2>
        <div class="matches-grid">
            {% for match in finished_matches %}
            <div class="match-card">
                <h3>{{ match.home_team.name }} vs {{ match.away_team.name }}</h3>
                <p><strong>Tarih:</strong> {{ match.date|date:"d M Y" }}</p>
                <p><strong>Skor:</strong> {{ match.home_score }} - {{ match.away_score }}</p>
                <p><strong>Lig:</strong> {{ match.league.name }}</p>
                {% if match.matchanalysis_set.first %}
                    <p><strong>Analiz:</strong> {{ match.matchanalysis_set.first.key_events|truncatewords:10 }}</p>
                {% endif %}
            </div>
            {% empty %}
            <p>Henüz biten maç bulunmuyor.</p>
            {% endfor %}
        </div>
    </div>

    <!-- BÖLÜM 2: GELECEK MAÇLAR -->
    <div class="section">
        <h2>⏭️ Gelecek Maçlar ({{ upcoming_matches.count }} maç)</h2>
        <div class="matches-grid">
            {% for match in upcoming_matches %}
            <div class="match-card">
                <h3>{{ match.home_team.name }} vs {{ match.away_team.name }}</h3>
                <p><strong>Tarih:</strong> {{ match.date|date:"d M Y H:i" }}</p>
                <p><strong>Lig:</strong> {{ match.league.name }}</p>
                <p><strong>Stadyum:</strong> {{ match.venue|default:"Belirtilmemiş" }}</p>
            </div>
            {% empty %}
            <p>Yaklaşan maç bulunmuyor.</p>
            {% endfor %}
        </div>
    </div>

    <!-- BÖLÜM 3: TAKIM İSTATİSTİKLERİ -->
    <div class="section">
        <h2>📊 Takım İstatistikleri</h2>
        <div class="stats-grid">
            {% for stat in team_stats %}
            <div class="stat-card">
                <h4>{{ stat.team.name }}</h4>
                <p><strong>Oynanan:</strong> {{ stat.matches_played }}</p>
                <p><strong>Galibiyet:</strong> {{ stat.wins }}</p>
                <p><strong>Beraberlik:</strong> {{ stat.draws }}</p>
                <p><strong>Mağlubiyet:</strong> {{ stat.losses }}</p>
                <p><strong>Gol Atılan:</strong> {{ stat.goals_for }}</p>
                <p><strong>Gol Yenilen:</strong> {{ stat.goals_against }}</p>
                <p><strong>Averaj:</strong> {{ stat.goal_difference|floatformat:0 }}</p>
            </div>
            {% empty %}
            <p>İstatistik bulunmuyor.</p>
            {% endfor %}
        </div>
    </div>

    <!-- BÖLÜM 4: LİG TABLOSU -->
    <div class="section">
        <h2>🏆 Lig Tabloları</h2>
        {% for table in league_tables %}
        <h3>{{ table.league.name }} - {{ table.season }} Sezonu</h3>
        <table class="league-table">
            <thead>
                <tr>
                    <th>Sıra</th>
                    <th>Takım</th>
                    <th>Puan</th>
                    <th>Oynanan</th>
                    <th>Averaj</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{ table.position }}</td>
                    <td>{{ table.team.name }}</td>
                    <td>{{ table.points }}</td>
                    <td>{{ table.matches_played }}</td>
                    <td>{{ table.goal_difference|floatformat:0 }}</td>
                </tr>
            </tbody>
        </table>
        {% empty %}
        <p>Lig tablosu bulunmuyor.</p>
        {% endfor %}
    </div>

    <!-- BÖLÜM 5: HAFTALAR ARASI ANALİZ -->
    <div class="section">
        <h2>📈 Haftalık İstatistikler</h2>
        <div class="stats-grid">
            {% for weekly in weekly_stats %}
            <div class="stat-card">
                <h4>{{ weekly.league.name }} - Hafta {{ weekly.week_number }}</h4>
                <p><strong>Toplam Maç:</strong> {{ weekly.total_matches }}</p>
                <p><strong>Toplam Gol:</strong> {{ weekly.total_goals }}</p>
                <p><strong>Maç Başına Gol:</strong> {{ weekly.average_goals|floatformat:1 }}</p>
                <p><strong>Tarih:</strong> {{ weekly.week_start|date:"d M" }} - {{ weekly.week_end|date:"d M Y" }}</p>
            </div>
            {% empty %}
            <p>Haftalık istatistik bulunmuyor.</p>
            {% endfor %}
        </div>
    </div>

    <!-- BÖLÜM 6: OYUNCU BİLGİLERİ -->
    <div class="section">
        <h2>⚽ En İyi Oyuncular</h2>
        <div class="stats-grid">
            {% for player in top_players %}
            <div class="stat-card">
                <h4>{{ player.name }} {{ player.surname }}</h4>
                <p><strong>Takım:</strong> {{ player.team.name }}</p>
                <p><strong>Pozisyon:</strong> {{ player.position }}</p>
                <p><strong>Yaş:</strong> {{ player.age }} yaşında</p>
                <p><strong>Maaş:</strong> ${{ player.salary|floatformat:0 }}</p>
            </div>
            {% empty %}
            <p>Oyuncu bilgisi bulunmuyor.</p>
            {% endfor %}
        </div>
    </div>

    <!-- ÖZET BİLGİLER -->
    <div class="section">
        <h2>📋 Genel Özet</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <h4>Toplam Lig</h4>
                <p><strong>{{ total_leagues }}</strong> aktif lig</p>
            </div>
            <div class="stat-card">
                <h4>Toplam Takım</h4>
                <p><strong>{{ total_teams }}</strong> takım</p>
            </div>
            <div class="stat-card">
                <h4>Bu Ay Maçlar</h4>
                <p><strong>{{ matches_this_month }}</strong> maç</p>
            </div>
            <div class="stat-card">
                <h4>Aktif Oyuncular</h4>
                <p><strong>{{ active_players }}</strong> oyuncu</p>
            </div>
        </div>
    </div>

</body>
</html>
